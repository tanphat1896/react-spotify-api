{"version":3,"sources":["AuthProvider.jsx","Playback.jsx","SearchResult.jsx","useToken.jsx","Setting.jsx","useSearch.jsx","App.js","reportWebVitals.js","index.js"],"names":["authContext","React","createContext","token","setToken","AuthProvider","children","useState","Provider","value","Playback","item","audioRef","useRef","autoplay","setAutoplay","useEffect","preview_url","current","load","play","catch","e","console","log","Pane","marginTop","padding","Heading","name","Checkbox","label","checked","onChange","target","controls","ref","src","type","SearchItem","onSelected","el","setEl","onClick","onMouseEnter","onMouseLeave","cursor","elevation","display","flexDirection","width","album","images","url","alt","Text","artists","SearchResult","items","setItem","gridTemplateColumns","gap","map","id","scopes","uri","useToken","clientId","secret","code","setCode","useContext","window","opener","onRedirect","fetch","headers","Authorization","btoa","body","method","then","rs","json","access_token","w","open","encodeURIComponent","URL","location","href","searchParams","get","close","Setting","show","setShow","setClientId","setSecret","login","SideSheet","isShown","onCloseComplete","Link","TextInputField","disabled","Button","appearance","intent","useSearch","query","setItems","searchDeb","useCallback","debounce","dir","tracks","search","App","q","setQ","background","SearchInput","placeholder","IconButton","marginLeft","icon","CogIcon","s","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4c6ba0b5.chunk.js","sourcesContent":["import React, { useState } from \"react\";\n\nexport const authContext = React.createContext({\n  token: null,\n  setToken: () => {},\n});\n\nfunction AuthProvider({ children }) {\n  const [token, setToken] = useState(\"\");\n  return <authContext.Provider value={{ token, setToken }}>{children}</authContext.Provider>;\n}\n\nexport default AuthProvider;\n","import { Checkbox, Heading, Pane } from \"evergreen-ui\";\nimport React, { useEffect, useRef, useState } from \"react\";\n\nfunction Playback({ item }) {\n  const audioRef = useRef();\n  const [autoplay, setAutoplay] = useState(false);\n\n  useEffect(() => {\n    if (!item || !item.preview_url) return;\n    audioRef.current?.load();\n    autoplay && audioRef.current?.play().catch(e => console.log(e));\n  }, [item, autoplay]);\n\n  if (!item) {\n    return null;\n  }\n\n  return (\n    <Pane marginTop={20} padding={20}>\n      <Heading>Track: {item?.name}</Heading>\n      <Checkbox label=\"Autoplay\" checked={autoplay} onChange={e => setAutoplay(e.target.checked)} />\n      <audio controls ref={audioRef}>\n        {item?.preview_url && <source src={item?.preview_url} type=\"audio/mpeg\"></source>}\n      </audio>\n    </Pane>\n  );\n}\n\nexport default Playback;\n","import { Heading, Pane, Text } from \"evergreen-ui\";\nimport React, { useState } from \"react\";\n\nfunction SearchResult({ items, setItem }) {\n  return (\n    <Pane display=\"grid\" padding={20} gridTemplateColumns=\"repeat(auto-fill, minmax(200px, 1fr))\" gap=\"10px\">\n      {items.map(item => (\n        <SearchItem item={item} key={item.id} onSelected={() => setItem(item)} />\n      ))}\n    </Pane>\n  );\n}\n\nfunction SearchItem({ item, onSelected }) {\n  const [el, setEl] = useState(1);\n\n  return (\n    <Pane\n      onClick={onSelected}\n      onMouseEnter={() => setEl(3)}\n      onMouseLeave={() => setEl(1)}\n      cursor=\"pointer\"\n      elevation={el}\n      display=\"flex\"\n      flexDirection=\"column\"\n      width=\"200px\"\n    >\n      <img src={item.album?.images?.[1]?.url} alt={item.name} />\n      <Pane padding={10}>\n        <Heading>{item.name}</Heading>\n        <Text>{item.artists?.[0].name}</Text>\n      </Pane>\n    </Pane>\n  );\n}\n\nexport default SearchResult;\n","import { useContext, useEffect, useState } from \"react\";\nimport { authContext } from \"./AuthProvider\";\n\nconst scopes = \"streaming user-read-email user-read-private user-read-playback-state user-modify-playback-state\";\nconst uri = \"http://localhost:3000\";\n\nfunction useToken(clientId, secret) {\n  const [code, setCode] = useState(\"\");\n  const { token, setToken } = useContext(authContext);\n\n  useEffect(() => {\n    window.opener?.onRedirect?.();\n  }, []);\n\n  function login() {\n    const w = window.open(\n      \"https://accounts.spotify.com/authorize\" +\n        \"?response_type=code\" +\n        \"&client_id=\" +\n        clientId +\n        (scopes ? \"&scope=\" + encodeURIComponent(scopes) : \"\") +\n        \"&redirect_uri=\" +\n        encodeURIComponent(uri),\n      \"OAuth\",\n      \"scrollbars=yes,status=yes\"\n    );\n    window.onRedirect = function () {\n      const code = new URL(w.location.href).searchParams.get(\"code\");\n      if (code) {\n        setCode(code);\n        w.close();\n      }\n    };\n  }\n\n  useEffect(() => {\n    if (!code || token) return;\n    fetch(\"https://accounts.spotify.com/api/token\", {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: `Basic ${window.btoa(clientId + \":\" + secret)}`,\n      },\n      body: `grant_type=authorization_code&code=${code}&redirect_uri=${uri}`,\n      method: \"POST\",\n    })\n      .then(rs => rs.json())\n      .then(json => {\n        console.log(json);\n        setToken(json.access_token);\n      });\n  }, [code, clientId, secret, setToken, token]);\n\n  return [code, login];\n}\n\nexport default useToken;\n","import React, { useContext, useState } from \"react\";\nimport { Button, Link, Pane, SideSheet, Text, TextInputField } from \"evergreen-ui\";\nimport { authContext } from \"./AuthProvider\";\nimport useToken from \"./useToken\";\n\nfunction Setting({ show, setShow }) {\n  const [clientId, setClientId] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n  const { token } = useContext(authContext);\n  const [code, login] = useToken(clientId, secret);\n\n  return (\n    <SideSheet isShown={show} onCloseComplete={() => setShow(false)}>\n      <Pane padding={20}>\n        <Text>\n          Retrieve at:{\" \"}\n          <Link href=\"https://developer.spotify.com/dashboard/applications\" target=\"_blank\">\n            Spotify dashboard\n          </Link>{\" \"}\n        </Text>\n        <TextInputField label=\"ClientId\" value={clientId} onChange={e => setClientId(e.target.value)} />\n        <TextInputField label=\"Secret\" value={secret} onChange={e => setSecret(e.target.value)} />\n        <TextInputField label=\"Code\" value={code} disabled />\n        <TextInputField label=\"Token\" value={token} disabled />\n        <Button appearance=\"primary\" intent=\"success\" onClick={login}>\n          Get token\n        </Button>\n      </Pane>\n    </SideSheet>\n  );\n}\n\nexport default Setting;\n","import { debounce } from \"lodash\";\nimport { useCallback, useContext, useEffect, useState } from \"react\";\nimport { authContext } from \"./AuthProvider\";\n\nfunction useSearch(query) {\n  const { token } = useContext(authContext);\n  const [items, setItems] = useState([]);\n\n  function search(query, token) {\n    console.log(\"Fetching\", query);\n    fetch(\"https://api.spotify.com/v1/search?type=track&q=\" + query, {\n      headers: {\n        Authorization: \"Bearer \" + token,\n      },\n    })\n      .then(rs => rs.json())\n      .then(json => {\n        console.dir(json?.tracks?.items);\n\n        setItems(json?.tracks?.items || []);\n      });\n  }\n\n  const searchDeb = useCallback(() => debounce((query, token) => search(query, token), 500), [])();\n\n  useEffect(() => {\n    searchDeb(query, token);\n  }, [query, token, searchDeb]);\n\n  return items;\n}\n\nexport default useSearch;\n","import { CogIcon, IconButton, Pane, SearchInput } from \"evergreen-ui\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { authContext } from \"./AuthProvider\";\nimport Playback from \"./Playback\";\nimport SearchResult from \"./SearchResult\";\nimport Setting from \"./Setting\";\nimport useSearch from \"./useSearch\";\n\nfunction App() {\n  const { token } = useContext(authContext);\n  const [q, setQ] = useState(\"\");\n  const items = useSearch(q);\n  const [item, setItem] = useState(null);\n  const [show, setShow] = useState(false);\n\n  useEffect(() => {\n    if (token) {\n      setShow(false);\n    }\n  }, [token]);\n\n  return (\n    <Pane>\n      <Pane background=\"#234361\" padding={10} display=\"flex\">\n        {token && <SearchInput placeholder=\"Search\" name=\"q\" value={q} onChange={e => setQ(e.target.value)} />}\n        <IconButton marginLeft={10} icon={CogIcon} onClick={() => setShow(s => !s)} />\n        <Setting show={show} setShow={setShow} />\n      </Pane>\n      <Playback item={item} />\n      <SearchResult items={items} setItem={setItem} />\n    </Pane>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport AuthProvider from \"./AuthProvider\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <AuthProvider>\n      <App />\n    </AuthProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}