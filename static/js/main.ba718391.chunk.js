(this["webpackJsonpreact-spotify-api"]=this["webpackJsonpreact-spotify-api"]||[]).push([[0],{131:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),a=n(18),r=n.n(a),i=(n(56),n(10)),s=n(142),u=n(151),l=n(146),d=n(147),j=n(6),b=o.a.createContext({token:"",setToken:function(){}});var f=function(e){var t=e.children,n=Object(c.useState)(""),o=Object(i.a)(n,2),a=o[0],r=o[1];return Object(j.jsx)(b.Provider,{value:{token:a,setToken:r},children:t})},p=n(144),h=n(150);var O=function(e){var t=e.item,n=Object(c.useRef)(),o=Object(c.useState)(!1),a=Object(i.a)(o,2),r=a[0],u=a[1];return Object(c.useEffect)((function(){var e,c;t&&t.preview_url&&(null===(e=n.current)||void 0===e||e.load(),r&&(null===(c=n.current)||void 0===c||c.play().catch((function(e){return console.log(e)}))))}),[t,r]),t?Object(j.jsxs)(s.a,{marginTop:20,padding:20,children:[Object(j.jsxs)(p.a,{children:["Track: ",null===t||void 0===t?void 0:t.name]}),Object(j.jsx)(h.a,{label:"Autoplay",checked:r,onChange:function(e){return u(e.target.checked)}}),Object(j.jsx)("audio",{controls:!0,ref:n,children:(null===t||void 0===t?void 0:t.preview_url)&&Object(j.jsx)("source",{src:null===t||void 0===t?void 0:t.preview_url,type:"audio/mpeg"})})]}):null},v=n(19);function x(e){var t,n,o,a,r=e.item,u=e.onSelected,l=Object(c.useState)(1),d=Object(i.a)(l,2),b=d[0],f=d[1];return Object(j.jsxs)(s.a,{onClick:u,onMouseEnter:function(){return f(3)},onMouseLeave:function(){return f(1)},cursor:"pointer",elevation:b,display:"flex",flexDirection:"column",width:"200px",children:[Object(j.jsx)("img",{src:null===(t=r.album)||void 0===t||null===(n=t.images)||void 0===n||null===(o=n[1])||void 0===o?void 0:o.url,alt:r.name}),Object(j.jsxs)(s.a,{padding:10,children:[Object(j.jsx)(p.a,{children:r.name}),Object(j.jsx)(v.a,{children:null===(a=r.artists)||void 0===a?void 0:a[0].name})]})]})}var m=function(e){var t=e.items,n=e.setItem;return Object(j.jsx)(s.a,{display:"grid",padding:20,gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"10px",children:t.map((function(e){return Object(j.jsx)(x,{item:e,onSelected:function(){return n(e)}},e.id)}))})},g=n(148),k=n(145),y=n(149),C=n(47),w="streaming user-read-email user-read-private user-read-playback-state user-modify-playback-state",S="https://tanphat1896.github.io/react-spotify-api/";var T=function(e,t){var n=Object(c.useState)(""),o=Object(i.a)(n,2),a=o[0],r=o[1],s=Object(c.useContext)(b),u=s.token,l=s.setToken;return Object(c.useEffect)((function(){var e,t;null===(e=window.opener)||void 0===e||null===(t=e.onRedirect)||void 0===t||t.call(e)}),[]),Object(c.useEffect)((function(){a&&!u&&fetch("https://accounts.spotify.com/api/token",{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic ".concat(window.btoa(e+":"+t))},body:"grant_type=authorization_code&code=".concat(a,"&redirect_uri=").concat(S),method:"POST"}).then((function(e){return e.json()})).then((function(e){console.log(e),l(e.access_token)}))}),[a,e,t,l,u]),[a,function(){var t=window.open("https://accounts.spotify.com/authorize?response_type=code&client_id="+e+"&scope="+encodeURIComponent(w)+"&redirect_uri="+encodeURIComponent(S),"OAuth","scrollbars=yes,status=yes");window.onRedirect=function(){var e=new URL(t.location.href).searchParams.get("code");e&&(r(e),t.close())}}]};var _=function(e){var t=e.show,n=e.setShow,o=Object(c.useState)(""),a=Object(i.a)(o,2),r=a[0],u=a[1],l=Object(c.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],h=Object(c.useContext)(b).token,O=T(r,f),x=Object(i.a)(O,2),m=x[0],w=x[1];return Object(j.jsx)(g.a,{isShown:t,onCloseComplete:function(){return n(!1)},children:Object(j.jsxs)(s.a,{padding:20,children:[Object(j.jsxs)(v.a,{children:["Retrieve at:"," ",Object(j.jsx)(k.a,{href:"https://developer.spotify.com/dashboard/applications",target:"_blank",children:"Spotify dashboard"})," "]}),Object(j.jsx)(y.a,{label:"ClientId",value:r,onChange:function(e){return u(e.target.value)}}),Object(j.jsx)(y.a,{label:"Secret",value:f,onChange:function(e){return p(e.target.value)}}),Object(j.jsx)(y.a,{label:"Code",value:m,disabled:!0}),Object(j.jsx)(y.a,{label:"Token",value:h,disabled:!0}),Object(j.jsx)(C.a,{appearance:"primary",intent:"success",onClick:w,children:"Get token"})]})})},E=n(46);var I=function(e){var t=Object(c.useContext)(b).token,n=Object(c.useState)([]),o=Object(i.a)(n,2),a=o[0],r=o[1],s=Object(c.useCallback)((function(){return Object(E.debounce)((function(e,t){return function(e,t){console.log("Fetching",e),fetch("https://api.spotify.com/v1/search?type=track&q="+e,{headers:{Authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(e){var t,n;console.dir(null===e||void 0===e||null===(t=e.tracks)||void 0===t?void 0:t.items),r((null===e||void 0===e||null===(n=e.tracks)||void 0===n?void 0:n.items)||[])}))}(e,t)}),500)}),[])();return Object(c.useEffect)((function(){e&&t&&s(e,t)}),[e,t,s]),a};var R=function(){var e=Object(c.useContext)(b).token,t=Object(c.useState)(""),n=Object(i.a)(t,2),o=n[0],a=n[1],r=I(o),f=Object(c.useState)(null),p=Object(i.a)(f,2),h=p[0],v=p[1],x=Object(c.useState)(!1),g=Object(i.a)(x,2),k=g[0],y=g[1];return Object(c.useEffect)((function(){e&&y(!1)}),[e]),Object(j.jsxs)(s.a,{children:[Object(j.jsxs)(s.a,{background:"#234361",padding:10,display:"flex",children:[e&&Object(j.jsx)(u.a,{placeholder:"Search",name:"q",value:o,onChange:function(e){return a(e.target.value)}}),Object(j.jsx)(l.a,{marginLeft:10,icon:d.a,onClick:function(){return y((function(e){return!e}))}}),Object(j.jsx)(_,{show:k,setShow:y})]}),Object(j.jsx)(O,{item:h}),Object(j.jsx)(m,{items:r,setItem:v})]})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,152)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),o(e),a(e),r(e)}))};r.a.render(Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(f,{children:Object(j.jsx)(R,{})})}),document.getElementById("root")),F()},56:function(e,t,n){}},[[131,1,2]]]);
//# sourceMappingURL=main.ba718391.chunk.js.map